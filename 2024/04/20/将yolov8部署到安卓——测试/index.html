<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>将yolov8部署到安卓——测试 | 泥嚎</title><meta name="author" content="XTY"><meta name="copyright" content="XTY"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="将yolov8部署到安卓——测试更换OpenCV版本需要在VS2019中测试ncnn推理yolo的效果，虽然在上一篇博客中我们安装OpenCV-Mobile，但是由于OpenCV-Mobile阉割了一些功能，所以为了方便测试，我们还是先换回Window的OpenCV，好在配置起来也不算麻烦，我下载的是4.8.0版本。下载后解压，配置环境变量，再在VS2019中类似上一篇博客配置即可，因为时间间隔有">
<meta property="og:type" content="article">
<meta property="og:title" content="将yolov8部署到安卓——测试">
<meta property="og:url" content="http://example.com/2024/04/20/%E5%B0%86yolov8%E9%83%A8%E7%BD%B2%E5%88%B0%E5%AE%89%E5%8D%93%E2%80%94%E2%80%94%E6%B5%8B%E8%AF%95/index.html">
<meta property="og:site_name" content="泥嚎">
<meta property="og:description" content="将yolov8部署到安卓——测试更换OpenCV版本需要在VS2019中测试ncnn推理yolo的效果，虽然在上一篇博客中我们安装OpenCV-Mobile，但是由于OpenCV-Mobile阉割了一些功能，所以为了方便测试，我们还是先换回Window的OpenCV，好在配置起来也不算麻烦，我下载的是4.8.0版本。下载后解压，配置环境变量，再在VS2019中类似上一篇博客配置即可，因为时间间隔有">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://images4.alphacoders.com/129/1291914.png">
<meta property="article:published_time" content="2024-04-20T01:54:00.000Z">
<meta property="article:modified_time" content="2024-04-21T04:22:10.305Z">
<meta property="article:author" content="XTY">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images4.alphacoders.com/129/1291914.png"><link rel="shortcut icon" href="https://pic.imgdb.cn/item/6616110668eb935713aa403b.webp"><link rel="canonical" href="http://example.com/2024/04/20/%E5%B0%86yolov8%E9%83%A8%E7%BD%B2%E5%88%B0%E5%AE%89%E5%8D%93%E2%80%94%E2%80%94%E6%B5%8B%E8%AF%95/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '将yolov8部署到安卓——测试',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2024-04-21 12:22:10'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/modify.css"><meta name="generator" content="Hexo 7.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://pic.imgdb.cn/item/661611e968eb935713ab9f06.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fa-brands fa-bilibili"></i><span> 视频</span></a></div><div class="menus_item"><a class="site-page" href="/Game/"><i class="fa-fw fa-solid fa-gamepaddarker"></i><span> 游戏</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 相关</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://images4.alphacoders.com/129/1291914.png')"><nav id="nav"><span id="blog-info"><a href="/" title="泥嚎"><span class="site-name">泥嚎</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fa-brands fa-bilibili"></i><span> 视频</span></a></div><div class="menus_item"><a class="site-page" href="/Game/"><i class="fa-fw fa-solid fa-gamepaddarker"></i><span> 游戏</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 相关</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">将yolov8部署到安卓——测试</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-04-20T01:54:00.000Z" title="发表于 2024-04-20 09:54:00">2024-04-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-21T04:22:10.305Z" title="更新于 2024-04-21 12:22:10">2024-04-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="将yolov8部署到安卓——测试"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img" style="background-image: url('https://images4.alphacoders.com/129/1291914.png');"></div><article class="post-content" id="article-container"><h1 id="将yolov8部署到安卓——测试"><a href="#将yolov8部署到安卓——测试" class="headerlink" title="将yolov8部署到安卓——测试"></a>将yolov8部署到安卓——测试</h1><h2 id="更换OpenCV版本"><a href="#更换OpenCV版本" class="headerlink" title="更换OpenCV版本"></a>更换OpenCV版本</h2><p>需要在VS2019中测试ncnn推理yolo的效果，虽然在上一篇博客中我们安装OpenCV-Mobile，但是由于OpenCV-Mobile阉割了一些功能，所以为了方便测试，我们还是先换回Window的OpenCV，好在配置起来也不算麻烦，我下载的是<a target="_blank" rel="noopener" href="https://opencv.org/releases/">4.8.0版本</a>。下载后解压，配置环境变量，再在VS2019中类似上一篇博客配置即可，因为时间间隔有些久，具体步骤我记不太清楚了，所以这一部分还请参考其他博客</p>
<h3 id="opencv-modules-included"><a href="#opencv-modules-included" class="headerlink" title="opencv modules included"></a>opencv modules included</h3><table>
<thead>
<tr>
<th>module</th>
<th>comment</th>
</tr>
</thead>
<tbody><tr>
<td>opencv_core</td>
<td>Mat, matrix operations, etc</td>
</tr>
<tr>
<td>opencv_imgproc</td>
<td>resize, cvtColor, warpAffine, etc</td>
</tr>
<tr>
<td>opencv_highgui</td>
<td>imread, imwrite</td>
</tr>
<tr>
<td>opencv_features2d</td>
<td>keypoint feature and matcher, etc (not included in opencv 2.x package)</td>
</tr>
<tr>
<td>opencv_photo</td>
<td>inpaint, etc</td>
</tr>
<tr>
<td>opencv_video</td>
<td>opticalflow, etc</td>
</tr>
</tbody></table>
<h3 id="opencv-modules-discarded"><a href="#opencv-modules-discarded" class="headerlink" title="opencv modules discarded"></a>opencv modules discarded</h3><table>
<thead>
<tr>
<th>module</th>
<th>comment</th>
</tr>
</thead>
<tbody><tr>
<td>opencv_androidcamera</td>
<td>use android Camera api instead</td>
</tr>
<tr>
<td>opencv_calib3d</td>
<td>camera calibration, rare uses on mobile</td>
</tr>
<tr>
<td>opencv_contrib</td>
<td>experimental functions, build part of the source externally if you need</td>
</tr>
<tr>
<td>opencv_dnn</td>
<td>very slow on mobile, try ncnn for neural network inference on mobile</td>
</tr>
<tr>
<td>opencv_dynamicuda</td>
<td>no cuda on mobile</td>
</tr>
<tr>
<td>opencv_flann</td>
<td>feature matching, rare uses on mobile, build the source externally if you need</td>
</tr>
<tr>
<td>opencv_gapi</td>
<td>graph based image processing, little gain on mobile</td>
</tr>
<tr>
<td>opencv_gpu</td>
<td>no cuda/opencl on mobile</td>
</tr>
<tr>
<td>opencv_imgcodecs</td>
<td>link with opencv_highgui instead</td>
</tr>
<tr>
<td>opencv_java</td>
<td>wrap your c++ code with jni</td>
</tr>
<tr>
<td>opencv_js</td>
<td>write native code on mobile</td>
</tr>
<tr>
<td>opencv_legacy</td>
<td>various good-old cv routines, build part of the source externally if you need</td>
</tr>
<tr>
<td>opencv_ml</td>
<td>train your ML algorithm on powerful pc or server</td>
</tr>
<tr>
<td>opencv_nonfree</td>
<td>the SIFT and SURF, use ORB which is faster and better</td>
</tr>
<tr>
<td>opencv_objdetect</td>
<td>HOG, cascade detector, use deep learning detector which is faster and better</td>
</tr>
<tr>
<td>opencv_ocl</td>
<td>no opencl on mobile</td>
</tr>
<tr>
<td>opencv_python</td>
<td>no python on mobile</td>
</tr>
<tr>
<td>opencv_shape</td>
<td>shape matching, rare uses on mobile, build the source externally if you need</td>
</tr>
<tr>
<td>opencv_stitching</td>
<td>image stitching, rare uses on mobile, build the source externally if you need</td>
</tr>
<tr>
<td>opencv_superres</td>
<td>do video super-resolution on powerful pc or server</td>
</tr>
<tr>
<td>opencv_ts</td>
<td>test modules, useless in production anyway</td>
</tr>
<tr>
<td>opencv_videoio</td>
<td>use android MediaCodec or ios AVFoundation api instead</td>
</tr>
<tr>
<td>opencv_videostab</td>
<td>do video stablization on powerful pc or server</td>
</tr>
<tr>
<td>opencv_viz</td>
<td>vtk is not available on mobile, write your own data visualization routines</td>
</tr>
</tbody></table>
<h2 id="模型转换（以Ultralytics官方提供的CoCo目标检测预训练权重为例）"><a href="#模型转换（以Ultralytics官方提供的CoCo目标检测预训练权重为例）" class="headerlink" title="模型转换（以Ultralytics官方提供的CoCo目标检测预训练权重为例）"></a>模型转换（以Ultralytics官方提供的CoCo目标检测预训练权重为例）</h2><p>​	这一步可以说是我踩坑最多的步骤了，碰到问题可以参考这篇<a target="_blank" rel="noopener" href="https://github.com/Digital2Slave/ncnn-android-yolov8-seg/wiki/">Wiki</a>和<a target="_blank" rel="noopener" href="https://github.com/FeiGeChuanShu/ncnn-android-yolov8/issues/8">Issues</a>，你能够得到大部分的解答。并且由于我转换的整个过程踩坑众多，所以很多细节也已经记不太清楚，不能保证我的步骤一定能够成功，仅供参考。</p>
<h3 id="安装yolov8"><a href="#安装yolov8" class="headerlink" title="安装yolov8"></a>安装yolov8</h3><p>​	这一步我在之前的博客也已经提过，网上也是教程众多，单纯的复述一遍意义不大，所以我打算把我踩的坑记录一下，希望能有启发作用。</p>
<h4 id="首先是关于选择pip-install-ultralytics还是git-clone的方法"><a href="#首先是关于选择pip-install-ultralytics还是git-clone的方法" class="headerlink" title="首先是关于选择pip install ultralytics还是git clone的方法"></a>首先是关于选择pip install ultralytics还是git clone的方法</h4><p>​	如果你看了上面的Wiki和issues的话，可以知道转换模型前是需要修改源码的。所以按理来说应该选择git clone的方法更方便修改，所以我一开始也是选择的git clone，但是</p>
<h4 id="关于模型转换参数的问题"><a href="#关于模型转换参数的问题" class="headerlink" title="关于模型转换参数的问题"></a>关于模型转换参数的问题</h4><p>​	基于我找到的测试代码，我只发现opset=13转换得到的模型会出现全屏检测框的问题，opset=12或11都没问题，其他参数的影响并不清楚。</p>
<p><img src="https://pic.imgdb.cn/item/662487c00ea9cb1403a5c5f2.png"></p>
<h4 id="关于转换得到的模型输出维度问题"><a href="#关于转换得到的模型输出维度问题" class="headerlink" title="关于转换得到的模型输出维度问题"></a>关于转换得到的模型输出维度问题</h4><p>​	最终的维度应该是1×144×8400，而不是1×84×8400，根据在ultralytics/nn/modules/head.py中修改的内容，forward输出应该是被拦腰截段了的，也就是说我们等于取了Yolo推理的中间结果，再完成后面的部分，所以送到ncnn的模型的输出维度并不是最终的输出维度。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">    <span class="string">"""Concatenates and returns predicted bounding boxes and class probabilities."""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.nl):</span><br><span class="line">        x[i] = torch.cat((self.cv2[i](x[i]), self.cv3[i](x[i])), <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> self.training:  <span class="comment"># Training path</span></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Inference path</span></span><br><span class="line">    shape = x[<span class="number">0</span>].shape  <span class="comment"># BCHW</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> self.dynamic <span class="keyword">or</span> self.shape != shape:</span><br><span class="line">        self.anchors, self.strides = (x.transpose(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">for</span> x <span class="keyword">in</span> make_anchors(x, self.stride, <span class="number">0.5</span>))</span><br><span class="line">        self.shape = shape</span><br><span class="line">    pred = torch.cat([xi.view(shape[<span class="number">0</span>], self.no, -<span class="number">1</span>) <span class="keyword">for</span> xi <span class="keyword">in</span> x],<span class="number">2</span>).permute(<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> pred</span><br><span class="line"></span><br><span class="line">    <span class="comment"># x_cat = torch.cat([xi.view(shape[0], self.no, -1) for xi in x], 2)</span></span><br><span class="line">    <span class="comment"># if self.export and self.format in {"saved_model", "pb", "tflite", "edgetpu", "tfjs"}:  # avoid TF FlexSplitV ops</span></span><br><span class="line">    <span class="comment">#     box = x_cat[:, : self.reg_max * 4]</span></span><br><span class="line">    <span class="comment">#     cls = x_cat[:, self.reg_max * 4 :]</span></span><br><span class="line">    <span class="comment"># else:</span></span><br><span class="line">    <span class="comment">#     box, cls = x_cat.split((self.reg_max * 4, self.nc), 1)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># if self.export and self.format in {"tflite", "edgetpu"}:</span></span><br><span class="line">    <span class="comment">#     # Precompute normalization factor to increase numerical stability</span></span><br><span class="line">    <span class="comment">#     # See https://github.com/ultralytics/ultralytics/issues/7371</span></span><br><span class="line">    <span class="comment">#     grid_h = shape[2]</span></span><br><span class="line">    <span class="comment">#     grid_w = shape[3]</span></span><br><span class="line">    <span class="comment">#     grid_size = torch.tensor([grid_w, grid_h, grid_w, grid_h], device=box.device).reshape(1, 4, 1)</span></span><br><span class="line">    <span class="comment">#     norm = self.strides / (self.stride[0] * grid_size)</span></span><br><span class="line">    <span class="comment">#     dbox = self.decode_bboxes(self.dfl(box) * norm, self.anchors.unsqueeze(0) * norm[:, :2])</span></span><br><span class="line">    <span class="comment"># else:</span></span><br><span class="line">    <span class="comment">#     dbox = self.decode_bboxes(self.dfl(box), self.anchors.unsqueeze(0)) * self.strides</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># y = torch.cat((dbox, cls.sigmoid()), 1)</span></span><br><span class="line">    <span class="comment"># return y if self.export else (y, x)</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="关于转换得到的模型结构问题"><a href="#关于转换得到的模型结构问题" class="headerlink" title="关于转换得到的模型结构问题"></a>关于转换得到的模型结构问题</h4><p>​	打开转换后得到的.parm文件，可以查看模型的结构。主要关注最后一层是不是Permute</p>
<figure class="highlight tex"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line">7767517</span><br><span class="line">181 217</span><br><span class="line">Input                    images                   0 1 images</span><br><span class="line">Convolution              /model.0/conv/Conv       1 1 images /model.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=16 1=3 3=2 4=1 5=1 6=432</span><br><span class="line">Swish                    /model.0/act/Mul         1 1 /model.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.1/conv/Conv       1 1 /model.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=32 1=3 3=2 4=1 5=1 6=4608</span><br><span class="line">Swish                    /model.1/act/Mul         1 1 /model.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.2/cv1/conv/Conv   1 1 /model.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=32 1=1 5=1 6=1024</span><br><span class="line">Swish                    /model.2/cv1/act/Mul     1 1 /model.2/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Slice                    /model.2/Split           1 2 /model.2/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 -23300=2,16,-233</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>0              1 3 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2</span><br><span class="line">Convolution              /model.2/m.0/cv1/conv/Conv 1 1 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2 /model.2/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=16 1=3 4=1 5=1 6=2304</span><br><span class="line">Swish                    /model.2/m.0/cv1/act/Mul 1 1 /model.2/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.2/m.0/cv2/conv/Conv 1 1 /model.2/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=16 1=3 4=1 5=1 6=2304</span><br><span class="line">Swish                    /model.2/m.0/cv2/act/Mul 1 1 /model.2/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">BinaryOp                 /model.2/m.0/Add         2 1 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.2/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.2/Concat          3 1 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.2/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.2/cv2/conv/Conv   1 1 /model.2/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=32 1=1 5=1 6=1536</span><br><span class="line">Swish                    /model.2/cv2/act/Mul     1 1 /model.2/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.2/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.3/conv/Conv       1 1 /model.2/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.3/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 3=2 4=1 5=1 6=18432</span><br><span class="line">Swish                    /model.3/act/Mul         1 1 /model.3/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.3/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.4/cv1/conv/Conv   1 1 /model.3/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=1 5=1 6=4096</span><br><span class="line">Swish                    /model.4/cv1/act/Mul     1 1 /model.4/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Slice                    /model.4/Split           1 2 /model.4/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 -23300=2,32,-233</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>1              1 3 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2</span><br><span class="line">Convolution              /model.4/m.0/cv1/conv/Conv 1 1 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2 /model.4/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=32 1=3 4=1 5=1 6=9216</span><br><span class="line">Swish                    /model.4/m.0/cv1/act/Mul 1 1 /model.4/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.4/m.0/cv2/conv/Conv 1 1 /model.4/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=32 1=3 4=1 5=1 6=9216</span><br><span class="line">Swish                    /model.4/m.0/cv2/act/Mul 1 1 /model.4/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">BinaryOp                 /model.4/m.0/Add         2 1 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.4/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>2              1 3 /model.4/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.4/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.4/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2</span><br><span class="line">Convolution              /model.4/m.1/cv1/conv/Conv 1 1 /model.4/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2 /model.4/m.1/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=32 1=3 4=1 5=1 6=9216</span><br><span class="line">Swish                    /model.4/m.1/cv1/act/Mul 1 1 /model.4/m.1/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/m.1/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.4/m.1/cv2/conv/Conv 1 1 /model.4/m.1/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/m.1/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=32 1=3 4=1 5=1 6=9216</span><br><span class="line">Swish                    /model.4/m.1/cv2/act/Mul 1 1 /model.4/m.1/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/m.1/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">BinaryOp                 /model.4/m.1/Add         2 1 /model.4/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.4/m.1/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/m.1/Add<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.4/Concat          4 1 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.4/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.4/m.1/Add<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.4/cv2/conv/Conv   1 1 /model.4/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=1 5=1 6=8192</span><br><span class="line">Swish                    /model.4/cv2/act/Mul     1 1 /model.4/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>3              1 2 /model.4/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.4/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Convolution              /model.5/conv/Conv       1 1 /model.4/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.5/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=3 3=2 4=1 5=1 6=73728</span><br><span class="line">Swish                    /model.5/act/Mul         1 1 /model.5/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.5/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.6/cv1/conv/Conv   1 1 /model.5/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=1 5=1 6=16384</span><br><span class="line">Swish                    /model.6/cv1/act/Mul     1 1 /model.6/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Slice                    /model.6/Split           1 2 /model.6/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 -23300=2,64,-233</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>4              1 3 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2</span><br><span class="line">Convolution              /model.6/m.0/cv1/conv/Conv 1 1 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2 /model.6/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.6/m.0/cv1/act/Mul 1 1 /model.6/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.6/m.0/cv2/conv/Conv 1 1 /model.6/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.6/m.0/cv2/act/Mul 1 1 /model.6/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">BinaryOp                 /model.6/m.0/Add         2 1 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.6/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>5              1 3 /model.6/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.6/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.6/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2</span><br><span class="line">Convolution              /model.6/m.1/cv1/conv/Conv 1 1 /model.6/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2 /model.6/m.1/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.6/m.1/cv1/act/Mul 1 1 /model.6/m.1/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/m.1/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.6/m.1/cv2/conv/Conv 1 1 /model.6/m.1/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/m.1/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.6/m.1/cv2/act/Mul 1 1 /model.6/m.1/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/m.1/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">BinaryOp                 /model.6/m.1/Add         2 1 /model.6/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.6/m.1/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/m.1/Add<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.6/Concat          4 1 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.6/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.6/m.1/Add<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.6/cv2/conv/Conv   1 1 /model.6/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=1 5=1 6=32768</span><br><span class="line">Swish                    /model.6/cv2/act/Mul     1 1 /model.6/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>6              1 2 /model.6/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.6/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Convolution              /model.7/conv/Conv       1 1 /model.6/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.7/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=256 1=3 3=2 4=1 5=1 6=294912</span><br><span class="line">Swish                    /model.7/act/Mul         1 1 /model.7/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.7/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.8/cv1/conv/Conv   1 1 /model.7/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=256 1=1 5=1 6=65536</span><br><span class="line">Swish                    /model.8/cv1/act/Mul     1 1 /model.8/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Slice                    /model.8/Split           1 2 /model.8/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 -23300=2,128,-233</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>7              1 3 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2</span><br><span class="line">Convolution              /model.8/m.0/cv1/conv/Conv 1 1 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2 /model.8/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=3 4=1 5=1 6=147456</span><br><span class="line">Swish                    /model.8/m.0/cv1/act/Mul 1 1 /model.8/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.8/m.0/cv2/conv/Conv 1 1 /model.8/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=3 4=1 5=1 6=147456</span><br><span class="line">Swish                    /model.8/m.0/cv2/act/Mul 1 1 /model.8/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">BinaryOp                 /model.8/m.0/Add         2 1 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.8/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.8/Concat          3 1 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.8/m.0/Add<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.8/cv2/conv/Conv   1 1 /model.8/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=256 1=1 5=1 6=98304</span><br><span class="line">Swish                    /model.8/cv2/act/Mul     1 1 /model.8/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.8/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.9/cv1/conv/Conv   1 1 /model.8/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=1 5=1 6=32768</span><br><span class="line">Swish                    /model.9/cv1/act/Mul     1 1 /model.9/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>8              1 2 /model.9/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.9/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Pooling                  /model.9/m/MaxPool       1 1 /model.9/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.9/m/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0 1=5 3=2 5=1</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>9              1 2 /model.9/m/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/m/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.9/m/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Pooling                  /model.9/m<span class="built_in">_</span>1/MaxPool     1 1 /model.9/m/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.9/m<span class="built_in">_</span>1/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0 1=5 3=2 5=1</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>10             1 2 /model.9/m<span class="built_in">_</span>1/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/m<span class="built_in">_</span>1/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.9/m<span class="built_in">_</span>1/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Pooling                  /model.9/m<span class="built_in">_</span>2/MaxPool     1 1 /model.9/m<span class="built_in">_</span>1/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.9/m<span class="built_in">_</span>2/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0 1=5 3=2 5=1</span><br><span class="line">Concat                   /model.9/Concat          4 1 /model.9/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.9/m/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.9/m<span class="built_in">_</span>1/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.9/m<span class="built_in">_</span>2/MaxPool<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.9/cv2/conv/Conv   1 1 /model.9/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=256 1=1 5=1 6=131072</span><br><span class="line">Swish                    /model.9/cv2/act/Mul     1 1 /model.9/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>11             1 2 /model.9/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.9/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Interp                   /model.10/Resize         1 1 /model.9/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.10/Resize<span class="built_in">_</span>output<span class="built_in">_</span>0 0=1 1=2.000000e+00 2=2.000000e+00</span><br><span class="line">Concat                   /model.11/Concat         2 1 /model.10/Resize<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.6/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.11/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.12/cv1/conv/Conv  1 1 /model.11/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=1 5=1 6=49152</span><br><span class="line">Swish                    /model.12/cv1/act/Mul    1 1 /model.12/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Slice                    /model.12/Split          1 2 /model.12/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 -23300=2,64,-233</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>12             1 2 /model.12/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 /model.12/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.12/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Convolution              /model.12/m.0/cv1/conv/Conv 1 1 /model.12/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.12/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.12/m.0/cv1/act/Mul 1 1 /model.12/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.12/m.0/cv2/conv/Conv 1 1 /model.12/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.12/m.0/cv2/act/Mul 1 1 /model.12/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.12/Concat         3 1 /model.12/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.12/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.12/cv2/conv/Conv  1 1 /model.12/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=1 5=1 6=24576</span><br><span class="line">Swish                    /model.12/cv2/act/Mul    1 1 /model.12/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>13             1 2 /model.12/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.12/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Interp                   /model.13/Resize         1 1 /model.12/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.13/Resize<span class="built_in">_</span>output<span class="built_in">_</span>0 0=1 1=2.000000e+00 2=2.000000e+00</span><br><span class="line">Concat                   /model.14/Concat         2 1 /model.13/Resize<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.4/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.14/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.15/cv1/conv/Conv  1 1 /model.14/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=1 5=1 6=12288</span><br><span class="line">Swish                    /model.15/cv1/act/Mul    1 1 /model.15/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Slice                    /model.15/Split          1 2 /model.15/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 -23300=2,32,-233</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>14             1 2 /model.15/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 /model.15/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.15/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Convolution              /model.15/m.0/cv1/conv/Conv 1 1 /model.15/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.15/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=32 1=3 4=1 5=1 6=9216</span><br><span class="line">Swish                    /model.15/m.0/cv1/act/Mul 1 1 /model.15/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.15/m.0/cv2/conv/Conv 1 1 /model.15/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=32 1=3 4=1 5=1 6=9216</span><br><span class="line">Swish                    /model.15/m.0/cv2/act/Mul 1 1 /model.15/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.15/Concat         3 1 /model.15/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.15/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.15/cv2/conv/Conv  1 1 /model.15/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=1 5=1 6=6144</span><br><span class="line">Swish                    /model.15/cv2/act/Mul    1 1 /model.15/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>15             1 3 /model.15/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.15/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.15/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.15/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2</span><br><span class="line">Convolution              /model.16/conv/Conv      1 1 /model.15/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2 /model.16/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 3=2 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.16/act/Mul        1 1 /model.16/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.16/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.17/Concat         2 1 /model.16/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.12/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.17/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.18/cv1/conv/Conv  1 1 /model.17/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=1 5=1 6=24576</span><br><span class="line">Swish                    /model.18/cv1/act/Mul    1 1 /model.18/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Slice                    /model.18/Split          1 2 /model.18/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 -23300=2,64,-233</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>16             1 2 /model.18/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 /model.18/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.18/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Convolution              /model.18/m.0/cv1/conv/Conv 1 1 /model.18/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.18/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.18/m.0/cv1/act/Mul 1 1 /model.18/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.18/m.0/cv2/conv/Conv 1 1 /model.18/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.18/m.0/cv2/act/Mul 1 1 /model.18/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.18/Concat         3 1 /model.18/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.18/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.18/cv2/conv/Conv  1 1 /model.18/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=1 5=1 6=24576</span><br><span class="line">Swish                    /model.18/cv2/act/Mul    1 1 /model.18/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>17             1 3 /model.18/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.18/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.18/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.18/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2</span><br><span class="line">Convolution              /model.19/conv/Conv      1 1 /model.18/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>2 /model.19/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=3 3=2 4=1 5=1 6=147456</span><br><span class="line">Swish                    /model.19/act/Mul        1 1 /model.19/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.19/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.20/Concat         2 1 /model.19/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.9/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.20/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.21/cv1/conv/Conv  1 1 /model.20/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=256 1=1 5=1 6=98304</span><br><span class="line">Swish                    /model.21/cv1/act/Mul    1 1 /model.21/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Slice                    /model.21/Split          1 2 /model.21/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 -23300=2,128,-233</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>18             1 2 /model.21/Split<span class="built_in">_</span>output<span class="built_in">_</span>1 /model.21/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.21/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Convolution              /model.21/m.0/cv1/conv/Conv 1 1 /model.21/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.21/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=3 4=1 5=1 6=147456</span><br><span class="line">Swish                    /model.21/m.0/cv1/act/Mul 1 1 /model.21/m.0/cv1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.21/m.0/cv2/conv/Conv 1 1 /model.21/m.0/cv1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=128 1=3 4=1 5=1 6=147456</span><br><span class="line">Swish                    /model.21/m.0/cv2/act/Mul 1 1 /model.21/m.0/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Concat                   /model.21/Concat         3 1 /model.21/Split<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/Split<span class="built_in">_</span>output<span class="built_in">_</span>1<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.21/m.0/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.21/cv2/conv/Conv  1 1 /model.21/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=256 1=1 5=1 6=98304</span><br><span class="line">Swish                    /model.21/cv2/act/Mul    1 1 /model.21/cv2/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Split                    splitncnn<span class="built_in">_</span>19             1 2 /model.21/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.21/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.21/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1</span><br><span class="line">Convolution              /model.22/cv2.0/cv2.0.0/conv/Conv 1 1 /model.15/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.22/cv2.0/cv2.0.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.22/cv2.0/cv2.0.0/act/Mul 1 1 /model.22/cv2.0/cv2.0.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.0/cv2.0.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv2.0/cv2.0.1/conv/Conv 1 1 /model.22/cv2.0/cv2.0.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.0/cv2.0.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.22/cv2.0/cv2.0.1/act/Mul 1 1 /model.22/cv2.0/cv2.0.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.0/cv2.0.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv2.0/cv2.0.2/Conv 1 1 /model.22/cv2.0/cv2.0.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.0/cv2.0.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=1 5=1 6=4096</span><br><span class="line">Convolution              /model.22/cv3.0/cv3.0.0/conv/Conv 1 1 /model.15/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.22/cv3.0/cv3.0.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=80 1=3 4=1 5=1 6=46080</span><br><span class="line">Swish                    /model.22/cv3.0/cv3.0.0/act/Mul 1 1 /model.22/cv3.0/cv3.0.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.0/cv3.0.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv3.0/cv3.0.1/conv/Conv 1 1 /model.22/cv3.0/cv3.0.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.0/cv3.0.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=80 1=3 4=1 5=1 6=57600</span><br><span class="line">Swish                    /model.22/cv3.0/cv3.0.1/act/Mul 1 1 /model.22/cv3.0/cv3.0.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.0/cv3.0.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv3.0/cv3.0.2/Conv 1 1 /model.22/cv3.0/cv3.0.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.0/cv3.0.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=80 1=1 5=1 6=6400</span><br><span class="line">Concat                   /model.22/Concat         2 1 /model.22/cv2.0/cv2.0.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.0/cv3.0.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv2.1/cv2.1.0/conv/Conv 1 1 /model.18/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.22/cv2.1/cv2.1.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=73728</span><br><span class="line">Swish                    /model.22/cv2.1/cv2.1.0/act/Mul 1 1 /model.22/cv2.1/cv2.1.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.1/cv2.1.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv2.1/cv2.1.1/conv/Conv 1 1 /model.22/cv2.1/cv2.1.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.1/cv2.1.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.22/cv2.1/cv2.1.1/act/Mul 1 1 /model.22/cv2.1/cv2.1.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.1/cv2.1.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv2.1/cv2.1.2/Conv 1 1 /model.22/cv2.1/cv2.1.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.1/cv2.1.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=1 5=1 6=4096</span><br><span class="line">Convolution              /model.22/cv3.1/cv3.1.0/conv/Conv 1 1 /model.18/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.22/cv3.1/cv3.1.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=80 1=3 4=1 5=1 6=92160</span><br><span class="line">Swish                    /model.22/cv3.1/cv3.1.0/act/Mul 1 1 /model.22/cv3.1/cv3.1.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.1/cv3.1.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv3.1/cv3.1.1/conv/Conv 1 1 /model.22/cv3.1/cv3.1.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.1/cv3.1.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=80 1=3 4=1 5=1 6=57600</span><br><span class="line">Swish                    /model.22/cv3.1/cv3.1.1/act/Mul 1 1 /model.22/cv3.1/cv3.1.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.1/cv3.1.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv3.1/cv3.1.2/Conv 1 1 /model.22/cv3.1/cv3.1.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.1/cv3.1.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=80 1=1 5=1 6=6400</span><br><span class="line">Concat                   /model.22/Concat<span class="built_in">_</span>1       2 1 /model.22/cv2.1/cv2.1.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.1/cv3.1.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/Concat<span class="built_in">_</span>1<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv2.2/cv2.2.0/conv/Conv 1 1 /model.21/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>1 /model.22/cv2.2/cv2.2.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=147456</span><br><span class="line">Swish                    /model.22/cv2.2/cv2.2.0/act/Mul 1 1 /model.22/cv2.2/cv2.2.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.2/cv2.2.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv2.2/cv2.2.1/conv/Conv 1 1 /model.22/cv2.2/cv2.2.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.2/cv2.2.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=3 4=1 5=1 6=36864</span><br><span class="line">Swish                    /model.22/cv2.2/cv2.2.1/act/Mul 1 1 /model.22/cv2.2/cv2.2.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.2/cv2.2.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv2.2/cv2.2.2/Conv 1 1 /model.22/cv2.2/cv2.2.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv2.2/cv2.2.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=64 1=1 5=1 6=4096</span><br><span class="line">Convolution              /model.22/cv3.2/cv3.2.0/conv/Conv 1 1 /model.21/cv2/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0<span class="built_in">_</span>splitncnn<span class="built_in">_</span>0 /model.22/cv3.2/cv3.2.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=80 1=3 4=1 5=1 6=184320</span><br><span class="line">Swish                    /model.22/cv3.2/cv3.2.0/act/Mul 1 1 /model.22/cv3.2/cv3.2.0/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.2/cv3.2.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv3.2/cv3.2.1/conv/Conv 1 1 /model.22/cv3.2/cv3.2.0/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.2/cv3.2.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=80 1=3 4=1 5=1 6=57600</span><br><span class="line">Swish                    /model.22/cv3.2/cv3.2.1/act/Mul 1 1 /model.22/cv3.2/cv3.2.1/conv/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.2/cv3.2.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Convolution              /model.22/cv3.2/cv3.2.2/Conv 1 1 /model.22/cv3.2/cv3.2.1/act/Mul<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.2/cv3.2.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 0=80 1=1 5=1 6=6400</span><br><span class="line">Concat                   /model.22/Concat<span class="built_in">_</span>2       2 1 /model.22/cv2.2/cv2.2.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/cv3.2/cv3.2.2/Conv<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/Concat<span class="built_in">_</span>2<span class="built_in">_</span>output<span class="built_in">_</span>0</span><br><span class="line">Reshape                  /model.22/Reshape        1 1 /model.22/Concat<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/Reshape<span class="built_in">_</span>output<span class="built_in">_</span>0 0=-1 1=144</span><br><span class="line">Reshape                  /model.22/Reshape<span class="built_in">_</span>1      1 1 /model.22/Concat<span class="built_in">_</span>1<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/Reshape<span class="built_in">_</span>1<span class="built_in">_</span>output<span class="built_in">_</span>0 0=-1 1=144</span><br><span class="line">Reshape                  /model.22/Reshape<span class="built_in">_</span>2      1 1 /model.22/Concat<span class="built_in">_</span>2<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/Reshape<span class="built_in">_</span>2<span class="built_in">_</span>output<span class="built_in">_</span>0 0=-1 1=144</span><br><span class="line">Concat                   /model.22/Concat<span class="built_in">_</span>3       3 1 /model.22/Reshape<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/Reshape<span class="built_in">_</span>1<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/Reshape<span class="built_in">_</span>2<span class="built_in">_</span>output<span class="built_in">_</span>0 /model.22/Concat<span class="built_in">_</span>3<span class="built_in">_</span>output<span class="built_in">_</span>0 0=1</span><br><span class="line">Permute                  /model.22/Transpose      1 1 /model.22/Concat<span class="built_in">_</span>3<span class="built_in">_</span>output<span class="built_in">_</span>0 output0 0=1</span><br></pre></td></tr></tbody></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>​	根据我的结果，如果能保证转换的Onnx模型是opset=12/11，输出维度是1×144×8400，转换为ncnn模型后得到的param结构最后一层是Permute层，就应该没有问题。</p>
<h2 id="代码测试"><a href="#代码测试" class="headerlink" title="代码测试"></a>代码测试</h2><p>​	目前网上的参考代码应该有<a target="_blank" rel="noopener" href="https://github.com/Digital2Slave/ncnn-android-yolov8-seg/blob/main/app/src/main/jni/yolo.cpp">这个</a>，<a target="_blank" rel="noopener" href="https://github.com/FeiGeChuanShu/ncnn-android-yolov8/blob/main/ncnn-yolov8s-obb/yolov8-obb.cpp">这个</a>和<a target="_blank" rel="noopener" href="https://github.com/DataXujing/ncnn_android_yolov8">这个</a>，其中前者的代码是针对分割任务的，中间的我测试会出现乱框现象，所以我采用的是最后一位大佬的代码（修改了一丢丢）。代码在下面，如果你是完全按照我的步骤来的话应该是可以直接用的，先不急着看，建议先看下面的修改内容。<img src="https://pic.imgdb.cn/item/66248d950ea9cb1403af94ae.png"></p>
<h3 id="yolo-h"><a href="#yolo-h" class="headerlink" title="yolo.h"></a>yolo.h</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> YOLO_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> YOLO_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/core/core.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/core/core.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/imgproc/imgproc.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;net.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Object</span></span><br><span class="line">{</span><br><span class="line">    cv::Rect_&lt;<span class="type">float</span>&gt; rect;</span><br><span class="line">    <span class="type">int</span> label;</span><br><span class="line">    <span class="type">float</span> prob;</span><br><span class="line">};</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GridAndStride</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> grid0;</span><br><span class="line">    <span class="type">int</span> grid1;</span><br><span class="line">    <span class="type">int</span> stride;</span><br><span class="line">};</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Yolo</span></span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Yolo</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">load</span><span class="params">(<span class="type">int</span> target_size, <span class="type">const</span> <span class="type">float</span>* mean_vals, <span class="type">const</span> <span class="type">float</span>* norm_vals, <span class="type">bool</span> use_gpu = <span class="literal">false</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">detect</span><span class="params">(<span class="type">const</span> cv::Mat&amp; rgb, std::vector&lt;Object&gt;&amp; objects, <span class="type">float</span> prob_threshold = <span class="number">0.4f</span>, <span class="type">float</span> nms_threshold = <span class="number">0.5f</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">draw</span><span class="params">(cv::Mat&amp; rgb, <span class="type">const</span> std::vector&lt;Object&gt;&amp; objects)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    ncnn::Net yolo;</span><br><span class="line">    <span class="type">int</span> target_size;</span><br><span class="line">    <span class="type">float</span> mean_vals[<span class="number">3</span>];</span><br><span class="line">    <span class="type">float</span> norm_vals[<span class="number">3</span>];</span><br><span class="line">    ncnn::UnlockedPoolAllocator blob_pool_allocator;</span><br><span class="line">    ncnn::PoolAllocator workspace_pool_allocator;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="yolo-cpp"><a href="#yolo-cpp" class="headerlink" title="yolo.cpp"></a>yolo.cpp</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"yolo.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/core/core.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/imgproc/imgproc.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//#include "cpu.h"</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">float</span> <span class="title">fast_exp</span><span class="params">(<span class="type">float</span> x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="keyword">union</span> {</span><br><span class="line">		<span class="type">uint32_t</span> i;</span><br><span class="line">		<span class="type">float</span> f;</span><br><span class="line">	} v{};</span><br><span class="line">	v.i = (<span class="number">1</span> &lt;&lt; <span class="number">23</span>) * (<span class="number">1.4426950409</span> * x + <span class="number">126.93490512f</span>);</span><br><span class="line">	<span class="keyword">return</span> v.f;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">float</span> <span class="title">sigmoid</span><span class="params">(<span class="type">float</span> x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1.0f</span> / (<span class="number">1.0f</span> + <span class="built_in">fast_exp</span>(-x));</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">float</span> <span class="title">intersection_area</span><span class="params">(<span class="type">const</span> Object&amp; a, <span class="type">const</span> Object&amp; b)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	cv::Rect_&lt;<span class="type">float</span>&gt; inter = a.rect &amp; b.rect;</span><br><span class="line">	<span class="keyword">return</span> inter.<span class="built_in">area</span>();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">qsort_descent_inplace</span><span class="params">(std::vector&lt;Object&gt;&amp; faceobjects, <span class="type">int</span> left, <span class="type">int</span> right)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i = left;</span><br><span class="line">	<span class="type">int</span> j = right;</span><br><span class="line">	<span class="type">float</span> p = faceobjects[(left + right) / <span class="number">2</span>].prob;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (i &lt;= j)</span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">while</span> (faceobjects[i].prob &gt; p)</span><br><span class="line">			i++;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (faceobjects[j].prob &lt; p)</span><br><span class="line">			j--;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (i &lt;= j)</span><br><span class="line">		{</span><br><span class="line">			<span class="comment">// swap</span></span><br><span class="line">			std::<span class="built_in">swap</span>(faceobjects[i], faceobjects[j]);</span><br><span class="line"></span><br><span class="line">			i++;</span><br><span class="line">			j--;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="comment">//     #pragma omp parallel sections</span></span><br><span class="line">	{</span><br><span class="line">		<span class="comment">//         #pragma omp section</span></span><br><span class="line">		{</span><br><span class="line">			<span class="keyword">if</span> (left &lt; j) <span class="built_in">qsort_descent_inplace</span>(faceobjects, left, j);</span><br><span class="line">		}</span><br><span class="line">		<span class="comment">//         #pragma omp section</span></span><br><span class="line">		{</span><br><span class="line">			<span class="keyword">if</span> (i &lt; right) <span class="built_in">qsort_descent_inplace</span>(faceobjects, i, right);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">qsort_descent_inplace</span><span class="params">(std::vector&lt;Object&gt;&amp; faceobjects)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="keyword">if</span> (faceobjects.<span class="built_in">empty</span>())</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">qsort_descent_inplace</span>(faceobjects, <span class="number">0</span>, faceobjects.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">nms_sorted_bboxes</span><span class="params">(<span class="type">const</span> std::vector&lt;Object&gt;&amp; faceobjects, std::vector&lt;<span class="type">int</span>&gt;&amp; picked, <span class="type">float</span> nms_threshold)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	picked.<span class="built_in">clear</span>();</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> n = faceobjects.<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line">	<span class="function">std::vector&lt;<span class="type">float</span>&gt; <span class="title">areas</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">	{</span><br><span class="line">		areas[i] = faceobjects[i].rect.width * faceobjects[i].rect.height;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">	{</span><br><span class="line">		<span class="type">const</span> Object&amp; a = faceobjects[i];</span><br><span class="line"></span><br><span class="line">		<span class="type">int</span> keep = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; (<span class="type">int</span>)picked.<span class="built_in">size</span>(); j++)</span><br><span class="line">		{</span><br><span class="line">			<span class="type">const</span> Object&amp; b = faceobjects[picked[j]];</span><br><span class="line"></span><br><span class="line">			<span class="comment">// intersection over union</span></span><br><span class="line">			<span class="type">float</span> inter_area = <span class="built_in">intersection_area</span>(a, b);</span><br><span class="line">			<span class="type">float</span> union_area = areas[i] + areas[picked[j]] - inter_area;</span><br><span class="line">			<span class="comment">// float IoU = inter_area / union_area</span></span><br><span class="line">			<span class="keyword">if</span> (inter_area / union_area &gt; nms_threshold)</span><br><span class="line">				keep = <span class="number">0</span>;</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (keep)</span><br><span class="line">			picked.<span class="built_in">push_back</span>(i);</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">generate_grids_and_stride</span><span class="params">(<span class="type">const</span> <span class="type">int</span> target_w, <span class="type">const</span> <span class="type">int</span> target_h, std::vector&lt;<span class="type">int</span>&gt;&amp; strides, std::vector&lt;GridAndStride&gt;&amp; grid_strides)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="type">int</span>)strides.<span class="built_in">size</span>(); i++)</span><br><span class="line">	{</span><br><span class="line">		<span class="type">int</span> stride = strides[i];</span><br><span class="line">		<span class="type">int</span> num_grid_w = target_w / stride;</span><br><span class="line">		<span class="type">int</span> num_grid_h = target_h / stride;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> g1 = <span class="number">0</span>; g1 &lt; num_grid_h; g1++)</span><br><span class="line">		{</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> g0 = <span class="number">0</span>; g0 &lt; num_grid_w; g0++)</span><br><span class="line">			{</span><br><span class="line">				GridAndStride gs;</span><br><span class="line">				gs.grid0 = g0;</span><br><span class="line">				gs.grid1 = g1;</span><br><span class="line">				gs.stride = stride;</span><br><span class="line">				grid_strides.<span class="built_in">push_back</span>(gs);</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">generate_proposals</span><span class="params">(std::vector&lt;GridAndStride&gt; grid_strides, <span class="type">const</span> ncnn::Mat&amp; pred, <span class="type">float</span> prob_threshold, std::vector&lt;Object&gt;&amp; objects)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> num_points = grid_strides.<span class="built_in">size</span>();</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> num_class = <span class="number">80</span>; <span class="comment">//&lt;--------------</span></span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> reg_max_1 = <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num_points; i++)</span><br><span class="line">	{</span><br><span class="line">		<span class="type">const</span> <span class="type">float</span>* scores = pred.<span class="built_in">row</span>(i) + <span class="number">4</span> * reg_max_1;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// find label with max score</span></span><br><span class="line">		<span class="type">int</span> label = <span class="number">-1</span>;</span><br><span class="line">		<span class="type">float</span> score = -FLT_MAX;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; num_class; k++)</span><br><span class="line">		{</span><br><span class="line">			<span class="type">float</span> confidence = scores[k];</span><br><span class="line">			<span class="keyword">if</span> (confidence &gt; score)</span><br><span class="line">			{</span><br><span class="line">				label = k;</span><br><span class="line">				score = confidence;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="type">float</span> box_prob = <span class="built_in">sigmoid</span>(score);</span><br><span class="line">		<span class="keyword">if</span> (box_prob &gt;= prob_threshold)</span><br><span class="line">		{</span><br><span class="line">			<span class="function">ncnn::Mat <span class="title">bbox_pred</span><span class="params">(reg_max_1, <span class="number">4</span>, (<span class="type">void</span>*)pred.row(i))</span></span>;</span><br><span class="line">			{</span><br><span class="line">				ncnn::Layer* softmax = ncnn::<span class="built_in">create_layer</span>(<span class="string">"Softmax"</span>);</span><br><span class="line"></span><br><span class="line">				ncnn::ParamDict pd;</span><br><span class="line">				pd.<span class="built_in">set</span>(<span class="number">0</span>, <span class="number">1</span>); <span class="comment">// axis</span></span><br><span class="line">				pd.<span class="built_in">set</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">				softmax-&gt;<span class="built_in">load_param</span>(pd);</span><br><span class="line"></span><br><span class="line">				ncnn::Option opt;</span><br><span class="line">				opt.num_threads = <span class="number">1</span>;</span><br><span class="line">				opt.use_packing_layout = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">				softmax-&gt;<span class="built_in">create_pipeline</span>(opt);</span><br><span class="line"></span><br><span class="line">				softmax-&gt;forward_inplace(bbox_pred, opt);</span><br><span class="line"></span><br><span class="line">				softmax-&gt;<span class="built_in">destroy_pipeline</span>(opt);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">delete</span> softmax;</span><br><span class="line">			}</span><br><span class="line"></span><br><span class="line">			<span class="type">float</span> pred_ltrb[<span class="number">4</span>];</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">			{</span><br><span class="line">				<span class="type">float</span> dis = <span class="number">0.f</span>;</span><br><span class="line">				<span class="type">const</span> <span class="type">float</span>* dis_after_sm = bbox_pred.<span class="built_in">row</span>(k);</span><br><span class="line">				<span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt; reg_max_1; l++)</span><br><span class="line">				{</span><br><span class="line">					dis += l * dis_after_sm[l];</span><br><span class="line">				}</span><br><span class="line"></span><br><span class="line">				pred_ltrb[k] = dis * grid_strides[i].stride;</span><br><span class="line">			}</span><br><span class="line"></span><br><span class="line">			<span class="type">float</span> pb_cx = (grid_strides[i].grid0 + <span class="number">0.5f</span>) * grid_strides[i].stride;</span><br><span class="line">			<span class="type">float</span> pb_cy = (grid_strides[i].grid1 + <span class="number">0.5f</span>) * grid_strides[i].stride;</span><br><span class="line"></span><br><span class="line">			<span class="type">float</span> x0 = pb_cx - pred_ltrb[<span class="number">0</span>];</span><br><span class="line">			<span class="type">float</span> y0 = pb_cy - pred_ltrb[<span class="number">1</span>];</span><br><span class="line">			<span class="type">float</span> x1 = pb_cx + pred_ltrb[<span class="number">2</span>];</span><br><span class="line">			<span class="type">float</span> y1 = pb_cy + pred_ltrb[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">			Object obj;</span><br><span class="line">			obj.rect.x = x0;</span><br><span class="line">			obj.rect.y = y0;</span><br><span class="line">			obj.rect.width = x1 - x0;</span><br><span class="line">			obj.rect.height = y1 - y0;</span><br><span class="line">			obj.label = label;</span><br><span class="line">			obj.prob = box_prob;</span><br><span class="line"></span><br><span class="line">			objects.<span class="built_in">push_back</span>(obj);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">Yolo::<span class="built_in">Yolo</span>()</span><br><span class="line">{</span><br><span class="line">	blob_pool_allocator.<span class="built_in">set_size_compare_ratio</span>(<span class="number">0.f</span>);</span><br><span class="line">	workspace_pool_allocator.<span class="built_in">set_size_compare_ratio</span>(<span class="number">0.f</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Yolo::load</span><span class="params">(<span class="type">int</span> _target_size, <span class="type">const</span> <span class="type">float</span>* _mean_vals, <span class="type">const</span> <span class="type">float</span>* _norm_vals, <span class="type">bool</span> use_gpu)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="comment">/*	yolo.clear();</span></span><br><span class="line"><span class="comment">		blob_pool_allocator.clear();</span></span><br><span class="line"><span class="comment">		workspace_pool_allocator.clear()*/</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//	ncnn::set_cpu_powersave(2);</span></span><br><span class="line">		<span class="comment">//	ncnn::set_omp_num_threads(ncnn::get_big_cpu_count());</span></span><br><span class="line"></span><br><span class="line">		yolo.opt = ncnn::<span class="built_in">Option</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//#if NCNN_VULKAN</span></span><br><span class="line">		<span class="comment">//	yolo.opt.use_vulkan_compute = use_gpu;</span></span><br><span class="line">		<span class="comment">//#endif</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//yolo.opt.num_threads = ncnn::get_big_cpu_count();</span></span><br><span class="line">			<span class="comment">//yolo.opt.blob_allocator = &amp;blob_pool_allocator;</span></span><br><span class="line">			<span class="comment">//yolo.opt.workspace_allocator = &amp;workspace_pool_allocator;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">//QFile::copy("assets:/pic/yolov8s_opt.param", "yolov8s_opt.param");</span></span><br><span class="line">		<span class="comment">//QFile::copy("assets:/pic/yolov8s_opt.bin", "yolov8s_opt.bin");</span></span><br><span class="line">		yolo.<span class="built_in">load_param</span>(<span class="string">"yolov8n-op11.param"</span>);</span><br><span class="line">		yolo.<span class="built_in">load_model</span>(<span class="string">"yolov8n-op11.bin"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">//	yolo.load_param("./model/yolov8s_opt.param");</span></span><br><span class="line">		<span class="comment">//	yolo.load_model("./model/yolov8s_opt.bin");</span></span><br><span class="line"></span><br><span class="line">		target_size = _target_size;</span><br><span class="line">		mean_vals[<span class="number">0</span>] = _mean_vals[<span class="number">0</span>];</span><br><span class="line">		mean_vals[<span class="number">1</span>] = _mean_vals[<span class="number">1</span>];</span><br><span class="line">		mean_vals[<span class="number">2</span>] = _mean_vals[<span class="number">2</span>];</span><br><span class="line">		norm_vals[<span class="number">0</span>] = _norm_vals[<span class="number">0</span>];</span><br><span class="line">		norm_vals[<span class="number">1</span>] = _norm_vals[<span class="number">1</span>];</span><br><span class="line">		norm_vals[<span class="number">2</span>] = _norm_vals[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Yolo::detect</span><span class="params">(<span class="type">const</span> cv::Mat&amp; rgb, std::vector&lt;Object&gt;&amp; objects, <span class="type">float</span> prob_threshold, <span class="type">float</span> nms_threshold)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> width = rgb.cols;</span><br><span class="line">	<span class="type">int</span> height = rgb.rows;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// pad to multiple of 32</span></span><br><span class="line">	<span class="type">int</span> w = width;</span><br><span class="line">	<span class="type">int</span> h = height;</span><br><span class="line">	<span class="type">float</span> scale = <span class="number">1.f</span>;</span><br><span class="line">	<span class="keyword">if</span> (w &gt; h)</span><br><span class="line">	{</span><br><span class="line">		scale = (<span class="type">float</span>)target_size / w;</span><br><span class="line">		w = target_size;</span><br><span class="line">		h = h * scale;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	{</span><br><span class="line">		scale = (<span class="type">float</span>)target_size / h;</span><br><span class="line">		h = target_size;</span><br><span class="line">		w = w * scale;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	ncnn::Mat in = ncnn::Mat::<span class="built_in">from_pixels_resize</span>(rgb.data, ncnn::Mat::PIXEL_RGB2BGR, width, height, w, h);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// pad to target_size rectangle</span></span><br><span class="line">	<span class="type">int</span> wpad = (w + <span class="number">31</span>) / <span class="number">32</span> * <span class="number">32</span> - w;</span><br><span class="line">	<span class="type">int</span> hpad = (h + <span class="number">31</span>) / <span class="number">32</span> * <span class="number">32</span> - h;</span><br><span class="line">	ncnn::Mat in_pad;</span><br><span class="line">	ncnn::<span class="built_in">copy_make_border</span>(in, in_pad, hpad / <span class="number">2</span>, hpad - hpad / <span class="number">2</span>, wpad / <span class="number">2</span>, wpad - wpad / <span class="number">2</span>, ncnn::BORDER_CONSTANT, <span class="number">0.f</span>);</span><br><span class="line"></span><br><span class="line">	in_pad.<span class="built_in">substract_mean_normalize</span>(<span class="number">0</span>, norm_vals);</span><br><span class="line"></span><br><span class="line">	ncnn::Extractor ex = yolo.<span class="built_in">create_extractor</span>();</span><br><span class="line"></span><br><span class="line">	ex.<span class="built_in">input</span>(<span class="string">"images"</span>, in_pad);</span><br><span class="line"></span><br><span class="line">	std::vector&lt;Object&gt; proposals;</span><br><span class="line"></span><br><span class="line">	ncnn::Mat out;</span><br><span class="line">	ex.<span class="built_in">extract</span>(<span class="string">"output0"</span>, out);</span><br><span class="line"></span><br><span class="line">	std::cout &lt;&lt; <span class="string">"---------YES, "</span> &lt;&lt; out.dims &lt;&lt; <span class="string">" width,"</span> &lt;&lt; out.w &lt;&lt; <span class="string">" height,"</span> &lt;&lt; out.h &lt;&lt; <span class="string">" , "</span> &lt;&lt; out.c &lt;&lt; std::endl;</span><br><span class="line">	<span class="comment">// 解析output + NMS TODO</span></span><br><span class="line"></span><br><span class="line">	std::vector&lt;<span class="type">int</span>&gt; strides = { <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span> }; <span class="comment">// might have stride=64</span></span><br><span class="line">	std::vector&lt;GridAndStride&gt; grid_strides;</span><br><span class="line">	<span class="built_in">generate_grids_and_stride</span>(in_pad.w, in_pad.h, strides, grid_strides);</span><br><span class="line">	<span class="built_in">generate_proposals</span>(grid_strides, out, prob_threshold, proposals);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// sort all proposals by score from highest to lowest</span></span><br><span class="line">	<span class="built_in">qsort_descent_inplace</span>(proposals);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// apply nms with nms_threshold</span></span><br><span class="line">	std::vector&lt;<span class="type">int</span>&gt; picked;</span><br><span class="line">	<span class="built_in">nms_sorted_bboxes</span>(proposals, picked, nms_threshold);</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> count = picked.<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line">	objects.<span class="built_in">resize</span>(count);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">	{</span><br><span class="line">		objects[i] = proposals[picked[i]];</span><br><span class="line"></span><br><span class="line">		<span class="comment">// adjust offset to original unpadded</span></span><br><span class="line">		<span class="type">float</span> x0 = (objects[i].rect.x - (wpad / <span class="number">2</span>)) / scale;</span><br><span class="line">		<span class="type">float</span> y0 = (objects[i].rect.y - (hpad / <span class="number">2</span>)) / scale;</span><br><span class="line">		<span class="type">float</span> x1 = (objects[i].rect.x + objects[i].rect.width - (wpad / <span class="number">2</span>)) / scale;</span><br><span class="line">		<span class="type">float</span> y1 = (objects[i].rect.y + objects[i].rect.height - (hpad / <span class="number">2</span>)) / scale;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// clip</span></span><br><span class="line">		x0 = std::<span class="built_in">max</span>(std::<span class="built_in">min</span>(x0, (<span class="type">float</span>)(width - <span class="number">1</span>)), <span class="number">0.f</span>);</span><br><span class="line">		y0 = std::<span class="built_in">max</span>(std::<span class="built_in">min</span>(y0, (<span class="type">float</span>)(height - <span class="number">1</span>)), <span class="number">0.f</span>);</span><br><span class="line">		x1 = std::<span class="built_in">max</span>(std::<span class="built_in">min</span>(x1, (<span class="type">float</span>)(width - <span class="number">1</span>)), <span class="number">0.f</span>);</span><br><span class="line">		y1 = std::<span class="built_in">max</span>(std::<span class="built_in">min</span>(y1, (<span class="type">float</span>)(height - <span class="number">1</span>)), <span class="number">0.f</span>);</span><br><span class="line"></span><br><span class="line">		objects[i].rect.x = x0;</span><br><span class="line">		objects[i].rect.y = y0;</span><br><span class="line">		objects[i].rect.width = x1 - x0;</span><br><span class="line">		objects[i].rect.height = y1 - y0;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="comment">// sort objects by area</span></span><br><span class="line">	<span class="keyword">struct</span></span><br><span class="line">	{</span><br><span class="line">		<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> Object&amp; a, <span class="type">const</span> Object&amp; b)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">		</span>{</span><br><span class="line">			<span class="keyword">return</span> a.rect.<span class="built_in">area</span>() &gt; b.rect.<span class="built_in">area</span>();</span><br><span class="line">		}</span><br><span class="line">	} objects_area_greater;</span><br><span class="line">	std::<span class="built_in">sort</span>(objects.<span class="built_in">begin</span>(), objects.<span class="built_in">end</span>(), objects_area_greater);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Yolo::draw</span><span class="params">(cv::Mat&amp; rgb, <span class="type">const</span> std::vector&lt;Object&gt;&amp; objects)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">static</span> <span class="type">const</span> <span class="type">char</span>* class_names[] = {</span><br><span class="line">		   <span class="string">"person"</span>, <span class="string">"bicycle"</span>, <span class="string">"car"</span>, <span class="string">"motorcycle"</span>, <span class="string">"airplane"</span>, <span class="string">"bus"</span>, <span class="string">"train"</span>, <span class="string">"truck"</span>, <span class="string">"boat"</span>, <span class="string">"traffic light"</span>,</span><br><span class="line">		   <span class="string">"fire hydrant"</span>, <span class="string">"stop sign"</span>, <span class="string">"parking meter"</span>, <span class="string">"bench"</span>, <span class="string">"bird"</span>, <span class="string">"cat"</span>, <span class="string">"dog"</span>, <span class="string">"horse"</span>, <span class="string">"sheep"</span>, <span class="string">"cow"</span>,</span><br><span class="line">		   <span class="string">"elephant"</span>, <span class="string">"bear"</span>, <span class="string">"zebra"</span>, <span class="string">"giraffe"</span>, <span class="string">"backpack"</span>, <span class="string">"umbrella"</span>, <span class="string">"handbag"</span>, <span class="string">"tie"</span>, <span class="string">"suitcase"</span>, <span class="string">"frisbee"</span>,</span><br><span class="line">		   <span class="string">"skis"</span>, <span class="string">"snowboard"</span>, <span class="string">"sports ball"</span>, <span class="string">"kite"</span>, <span class="string">"baseball bat"</span>, <span class="string">"baseball glove"</span>, <span class="string">"skateboard"</span>, <span class="string">"surfboard"</span>,</span><br><span class="line">		   <span class="string">"tennis racket"</span>, <span class="string">"bottle"</span>, <span class="string">"wine glass"</span>, <span class="string">"cup"</span>, <span class="string">"fork"</span>, <span class="string">"knife"</span>, <span class="string">"spoon"</span>, <span class="string">"bowl"</span>, <span class="string">"banana"</span>, <span class="string">"apple"</span>,</span><br><span class="line">		   <span class="string">"sandwich"</span>, <span class="string">"orange"</span>, <span class="string">"broccoli"</span>, <span class="string">"carrot"</span>, <span class="string">"hot dog"</span>, <span class="string">"pizza"</span>, <span class="string">"donut"</span>, <span class="string">"cake"</span>, <span class="string">"chair"</span>, <span class="string">"couch"</span>,</span><br><span class="line">		   <span class="string">"potted plant"</span>, <span class="string">"bed"</span>, <span class="string">"dining table"</span>, <span class="string">"toilet"</span>, <span class="string">"tv"</span>, <span class="string">"laptop"</span>, <span class="string">"mouse"</span>, <span class="string">"remote"</span>, <span class="string">"keyboard"</span>, <span class="string">"cell phone"</span>,</span><br><span class="line">		   <span class="string">"microwave"</span>, <span class="string">"oven"</span>, <span class="string">"toaster"</span>, <span class="string">"sink"</span>, <span class="string">"refrigerator"</span>, <span class="string">"book"</span>, <span class="string">"clock"</span>, <span class="string">"vase"</span>, <span class="string">"scissors"</span>, <span class="string">"teddy bear"</span>,</span><br><span class="line">		   <span class="string">"hair drier"</span>, <span class="string">"toothbrush"</span></span><br><span class="line">	};</span><br><span class="line">	<span class="comment">//    static const char* class_names[] = {"blur", "phone", "reflectLight", "reflection"};</span></span><br><span class="line">	<span class="type">static</span> <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> colors[<span class="number">81</span>][<span class="number">3</span>] = {</span><br><span class="line">			{<span class="number">56</span>,  <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">226</span>, <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">94</span>,  <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">37</span>,  <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">94</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">226</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">18</span>,  <span class="number">255</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">151</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">170</span>, <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">56</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">75</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">75</span>,  <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">169</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">207</span>},</span><br><span class="line">			{<span class="number">75</span>,  <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">207</span>, <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">37</span>,  <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">207</span>, <span class="number">255</span>},</span><br><span class="line">			{<span class="number">94</span>,  <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">113</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">18</span>,  <span class="number">0</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">56</span>},</span><br><span class="line">			{<span class="number">18</span>,  <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">226</span>},</span><br><span class="line">			{<span class="number">170</span>, <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">245</span>},</span><br><span class="line">			{<span class="number">151</span>, <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">132</span>, <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">75</span>,  <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">151</span>, <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">151</span>, <span class="number">255</span>},</span><br><span class="line">			{<span class="number">132</span>, <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">245</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">132</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">226</span>, <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">37</span>,  <span class="number">0</span>},</span><br><span class="line">			{<span class="number">207</span>, <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">207</span>},</span><br><span class="line">			{<span class="number">94</span>,  <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">226</span>, <span class="number">255</span>},</span><br><span class="line">			{<span class="number">56</span>,  <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">94</span>,  <span class="number">0</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">113</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">132</span>, <span class="number">255</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">132</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">170</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">188</span>},</span><br><span class="line">			{<span class="number">113</span>, <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">245</span>, <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">113</span>, <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">188</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">113</span>, <span class="number">255</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">56</span>,  <span class="number">255</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">113</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">188</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">94</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">18</span>},</span><br><span class="line">			{<span class="number">18</span>,  <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">132</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">188</span>, <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">245</span>, <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">169</span>, <span class="number">255</span>},</span><br><span class="line">			{<span class="number">37</span>,  <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">151</span>},</span><br><span class="line">			{<span class="number">188</span>, <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">37</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">170</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">37</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">75</span>,  <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">255</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">207</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">0</span>,   <span class="number">226</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">245</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">188</span>, <span class="number">255</span>, <span class="number">0</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">18</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">75</span>},</span><br><span class="line">			{<span class="number">0</span>,   <span class="number">255</span>, <span class="number">151</span>},</span><br><span class="line">			{<span class="number">255</span>, <span class="number">56</span>,  <span class="number">0</span>},</span><br><span class="line">			{<span class="number">245</span>, <span class="number">255</span>, <span class="number">0</span>}</span><br><span class="line">	};</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> color_index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; objects.<span class="built_in">size</span>(); i++)</span><br><span class="line">	{</span><br><span class="line">		<span class="type">const</span> Object&amp; obj = objects[i];</span><br><span class="line"></span><br><span class="line">		<span class="comment">//         fprintf(stderr, "%d = %.5f at %.2f %.2f %.2f x %.2f\n", obj.label, obj.prob,</span></span><br><span class="line">		<span class="comment">//                 obj.rect.x, obj.rect.y, obj.rect.width, obj.rect.height);</span></span><br><span class="line"></span><br><span class="line">		<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span>* color = colors[color_index % <span class="number">19</span>];</span><br><span class="line">		color_index++;</span><br><span class="line"></span><br><span class="line">		<span class="function">cv::Scalar <span class="title">cc</span><span class="params">(color[<span class="number">0</span>], color[<span class="number">1</span>], color[<span class="number">2</span>])</span></span>;</span><br><span class="line"></span><br><span class="line">		cv::<span class="built_in">rectangle</span>(rgb, obj.rect, cc, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">		<span class="type">char</span> text[<span class="number">256</span>];</span><br><span class="line">		<span class="built_in">sprintf_s</span>(text, <span class="string">"%s %.1f%%"</span>, class_names[obj.label], obj.prob * <span class="number">100</span>);</span><br><span class="line">		<span class="comment">//std::string text = class_names[obj.label] + std::to_string(round(obj.prob * 10000)/100);</span></span><br><span class="line"></span><br><span class="line">		<span class="type">int</span> baseLine = <span class="number">0</span>;</span><br><span class="line">		cv::Size label_size = cv::<span class="built_in">getTextSize</span>(text, cv::FONT_HERSHEY_SIMPLEX, <span class="number">0.5</span>, <span class="number">1</span>, &amp;baseLine);</span><br><span class="line"></span><br><span class="line">		<span class="type">int</span> x = obj.rect.x;</span><br><span class="line">		<span class="type">int</span> y = obj.rect.y - label_size.height - baseLine;</span><br><span class="line">		<span class="keyword">if</span> (y &lt; <span class="number">0</span>)</span><br><span class="line">			y = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (x + label_size.width &gt; rgb.cols)</span><br><span class="line">			x = rgb.cols - label_size.width;</span><br><span class="line"></span><br><span class="line">		cv::<span class="built_in">rectangle</span>(rgb, cv::<span class="built_in">Rect</span>(cv::<span class="built_in">Point</span>(x, y), cv::<span class="built_in">Size</span>(label_size.width, label_size.height + baseLine)), cc, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">		cv::Scalar textcc = (color[<span class="number">0</span>] + color[<span class="number">1</span>] + color[<span class="number">2</span>] &gt;= <span class="number">381</span>) ? cv::<span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>) : cv::<span class="built_in">Scalar</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</span><br><span class="line"></span><br><span class="line">		cv::<span class="built_in">putText</span>(rgb, text, cv::<span class="built_in">Point</span>(x, y + label_size.height), cv::FONT_HERSHEY_SIMPLEX, <span class="number">0.5</span>, textcc, <span class="number">1</span>);</span><br><span class="line">	}</span><br><span class="line">	cv::<span class="built_in">imshow</span>(<span class="string">"image"</span>, rgb);</span><br><span class="line">	<span class="comment">//cv::imwrite("demo.png", image);</span></span><br><span class="line">	cv::<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"yolo.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"net.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(USE_NCNN_SIMPLEOCV)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"simpleocv.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/core/core.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/imgproc/imgproc.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;float.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	Yolo *yolov8 = <span class="keyword">new</span> <span class="built_in">Yolo</span>();</span><br><span class="line">	cv::Mat m = cv::<span class="built_in">imread</span>(<span class="string">"image1.png"</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="type">int</span> target_size = <span class="number">640</span>;</span><br><span class="line">	<span class="type">float</span> norm_vals[<span class="number">3</span>] = { <span class="number">1</span> / <span class="number">255.f</span>, <span class="number">1</span> / <span class="number">255.f</span>, <span class="number">1</span> / <span class="number">255.f</span> };</span><br><span class="line">	<span class="type">float</span> mean_vals[<span class="number">3</span>] = { <span class="number">103.53f</span>, <span class="number">116.28f</span>, <span class="number">123.675f</span> };</span><br><span class="line"></span><br><span class="line">	yolov8-&gt;<span class="built_in">load</span>(target_size, mean_vals, norm_vals);</span><br><span class="line">	std::vector&lt;Object&gt; objects;</span><br><span class="line">	yolov8-&gt;<span class="built_in">detect</span>(m, objects);</span><br><span class="line">	std::cout &lt;&lt; objects.<span class="built_in">size</span>();</span><br><span class="line">	yolov8-&gt;<span class="built_in">draw</span>(m, objects);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="修改内容（只修改yolo-cpp，修改后的内容参考上面的代码）"><a href="#修改内容（只修改yolo-cpp，修改后的内容参考上面的代码）" class="headerlink" title="修改内容（只修改yolo.cpp，修改后的内容参考上面的代码）"></a>修改内容（只修改yolo.cpp，修改后的内容参考上面的代码）</h3><h4 id="加载的模型"><a href="#加载的模型" class="headerlink" title="加载的模型"></a>加载的模型</h4><p>​	在大概256行的位置要把加载的模型修改为你自己的，上面的QFile也注释掉，如果你没有装Qt的话</p>
<p><img src="https://pic.imgdb.cn/item/66248eea0ea9cb1403b1a9d5.png"></p>
<h4 id="类别数量和类别标签"><a href="#类别数量和类别标签" class="headerlink" title="类别数量和类别标签"></a>类别数量和类别标签</h4><p>​	在大概148行的位置把类别数量设置成和你的模型匹配，以本教程使用的CoCo目标检测模型为例是80</p>
<p><img src="https://pic.imgdb.cn/item/66248f560ea9cb1403b36695.png">	对应的类别标签也要修改，大概370的位置</p>
<p>​	<img src="https://pic.imgdb.cn/item/66248faa0ea9cb1403b3efb1.png"></p>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><p>​	加载的模型要改，类别数量要改，类别标签要改。</p>
<h2 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h2><p>​	采用官方提供的yolov8n.pt模型，选择opset=12，simplify=True，使用<a target="_blank" rel="noopener" href="https://convertmodel.com/">在线网站</a>转换时三项全部勾选，转换得到模型测试效果如下：</p>
<p><img src="https://pic.imgdb.cn/item/662490d90ea9cb1403b5fb82.png"></p>
<h2 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h2><p>​	模型转换参数opset不能为13，转换得到输出维度应该是1×144×8400，模型结构最后一层应该是Permute。如果已经修改源码，但是转换一直不成功，可能是环境冲突，也就是你调用的ultralytics包并不是你修改过的。</p>
<p>​	网上有多个版本的测试代码，如果模型转换正确，都能够成功运行，但是预测结果不一定正确，可以多找几个版本的代码测试。</p>
<h2 id="推理代码解读"><a href="#推理代码解读" class="headerlink" title="推理代码解读"></a>推理代码解读</h2><h2 id="Object类"><a href="#Object类" class="headerlink" title="Object类"></a>Object类</h2><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Object</span></span><br><span class="line">{</span><br><span class="line">    cv::Rect_&lt;<span class="type">float</span>&gt; rect;</span><br><span class="line">    <span class="type">int</span> label;</span><br><span class="line">    <span class="type">float</span> prob;</span><br><span class="line">    cv::Mat mask;</span><br><span class="line">    std::vector&lt;<span class="type">float</span>&gt; mask_feat;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>

<h2 id="GridAndStride类"><a href="#GridAndStride类" class="headerlink" title="GridAndStride类"></a>GridAndStride类</h2><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">GridAndStride</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> grid0;</span><br><span class="line">    <span class="type">int</span> grid1;</span><br><span class="line">    <span class="type">int</span> stride;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>



<h2 id="main"><a href="#main" class="headerlink" title="main"></a>main</h2><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    cv::Mat m = cv::<span class="built_in">imread</span>(<span class="string">"20240416111118.png"</span>, <span class="number">1</span>);</span><br><span class="line">    std::vector&lt;Object&gt; objects;</span><br><span class="line">    <span class="built_in">detect_yolov8</span>(m, objects);</span><br><span class="line">    <span class="built_in">draw_objects</span>(m, objects);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>在 OpenCV 中，<code>Mat</code> 类的主要成员变量如下：</p>
<ol>
<li><code>int flags</code>：用于存储关于矩阵的一些标志，例如矩阵的类型、通道数等信息。</li>
<li><code>int dims</code>：表示矩阵的维数。</li>
<li><code>int rows</code>：表示矩阵的行数。</li>
<li><code>int cols</code>：表示矩阵的列数。</li>
<li><code>uchar* data</code>：指向矩阵数据存储的指针。</li>
<li><code>std::shared_ptr&lt;MatAllocator&gt; allocator</code>：智能指针，用于内存分配和释放。</li>
<li><code>std::vector&lt;int&gt; size</code>：存储矩阵每个维度的大小。</li>
<li><code>std::vector&lt;int&gt; step</code>：存储矩阵每个维度的步长。</li>
</ol>
</blockquote>
<h2 id="detect-yolo"><a href="#detect-yolo" class="headerlink" title="detect_yolo"></a>detect_yolo</h2><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">detect_yolov8</span><span class="params">(<span class="type">const</span> cv::Mat&amp; bgr, std::vector&lt;Object&gt;&amp; objects)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    ncnn::Net yolov8; <span class="comment">//定义网络</span></span><br><span class="line"></span><br><span class="line">    yolov8.<span class="built_in">load_param</span>(<span class="string">"yolov8s-op13.param"</span>); <span class="comment">//加载参数</span></span><br><span class="line">    yolov8.<span class="built_in">load_model</span>(<span class="string">"yolov8s-op13.bin"</span>); <span class="comment">//加载模型</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> width = bgr.cols; <span class="comment">//图像的宽</span></span><br><span class="line">    <span class="type">int</span> height = bgr.rows;<span class="comment">//图像的高</span></span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> target_size = <span class="number">640</span>;<span class="comment">//输入图片大小？</span></span><br><span class="line">    <span class="type">const</span> <span class="type">float</span> prob_threshold = <span class="number">0.4f</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">float</span> nms_threshold = <span class="number">0.5f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在图像旁边补像素</span></span><br><span class="line">    <span class="type">int</span> w = width;</span><br><span class="line">    <span class="type">int</span> h = height;</span><br><span class="line">    <span class="type">float</span> scale = <span class="number">1.f</span>;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    在C++中，这三种写法的区别在于数值类型和表示精度的方式：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">float scale = 1.f;：这种写法明确地将数值标记为单精度浮点数，.f 表示这是一个浮点数，用于表示精度。这样做可以确保初始化的值是单精度浮点数，并且更加清晰和明确。</span></span><br><span class="line"><span class="comment">float scale = 1.0;：这种写法使用的是双精度浮点数（双精度浮点数默认情况下用 double 类型表示）。虽然这也可以用于初始化一个 float 类型的变量，但它是一个双精度浮点数，会占用更多的内存，而且可能会引入不必要的精度。</span></span><br><span class="line"><span class="comment">float scale = 1;：这种写法使用的是整数，编译器会自动将整数转换为单精度浮点数，然后再赋值给 float 类型的变量。虽然这种写法是合法的，但它的可读性较差，并且可能引入不必要的类型转换。</span></span><br><span class="line"><span class="comment">因此，推荐使用 float scale = 1.f; 这种写法，因为它更加明确和清晰，可以确保初始化的值是单精度浮点数，并且不会引入不必要的类型转换或精度损失。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//把图像给变成1：1</span></span><br><span class="line">    <span class="keyword">if</span> (w &gt; h)</span><br><span class="line">    {</span><br><span class="line">        scale = (<span class="type">float</span>)target_size / w;</span><br><span class="line">        w = target_size;</span><br><span class="line">        h = h * scale;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    {</span><br><span class="line">        scale = (<span class="type">float</span>)target_size / h;</span><br><span class="line">        h = target_size;</span><br><span class="line">        w = w * scale;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ncnn::Mat in = ncnn::Mat::<span class="built_in">from_pixels_resize</span>(bgr.data, ncnn::Mat::PIXEL_BGR2RGB, width, height, w, h);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// pad to target_size rectangle</span></span><br><span class="line">    <span class="type">int</span> wpad = (w + <span class="number">31</span>) / <span class="number">32</span> * <span class="number">32</span> - w; <span class="comment">//计算宽度方向上需要填充的像素数，确保填充后的宽度是 32 的整数倍。</span></span><br><span class="line">    <span class="type">int</span> hpad = (h + <span class="number">31</span>) / <span class="number">32</span> * <span class="number">32</span> - h; <span class="comment">//计算高度方向上需要填充的像素数，确保填充后的高度是 32 的整数倍</span></span><br><span class="line">    ncnn::Mat in_pad;</span><br><span class="line">    ncnn::<span class="built_in">copy_make_border</span>(in, in_pad, hpad / <span class="number">2</span>, hpad - hpad / <span class="number">2</span>, wpad / <span class="number">2</span>, wpad - wpad / <span class="number">2</span>, ncnn::BORDER_CONSTANT, <span class="number">0.f</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">float</span> norm_vals[<span class="number">3</span>] = { <span class="number">1</span> / <span class="number">255.f</span>, <span class="number">1</span> / <span class="number">255.f</span>, <span class="number">1</span> / <span class="number">255.f</span> };</span><br><span class="line">    in_pad.<span class="built_in">substract_mean_normalize</span>(<span class="number">0</span>, norm_vals);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ncnn::Extractor ex = yolov8.<span class="built_in">create_extractor</span>();</span><br><span class="line">    ex.<span class="built_in">input</span>(<span class="string">"images"</span>, in_pad);</span><br><span class="line"></span><br><span class="line">    ncnn::Mat out;</span><br><span class="line">    ex.<span class="built_in">extract</span>(<span class="string">"output0"</span>, out);</span><br><span class="line"></span><br><span class="line">    ncnn::Mat mask_proto;</span><br><span class="line">    ex.<span class="built_in">extract</span>(<span class="string">"output1"</span>, mask_proto);</span><br><span class="line"></span><br><span class="line">    std::vector&lt;<span class="type">int</span>&gt; strides = { <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span> };</span><br><span class="line">    std::vector&lt;GridAndStride&gt; grid_strides;</span><br><span class="line">    <span class="built_in">generate_grids_and_stride</span>(in_pad.w, in_pad.h, strides, grid_strides);</span><br><span class="line"></span><br><span class="line">    std::vector&lt;Object&gt; proposals;</span><br><span class="line">    std::vector&lt;Object&gt; objects8;</span><br><span class="line">    <span class="built_in">generate_proposals</span>(grid_strides, out, prob_threshold, objects8);</span><br><span class="line"></span><br><span class="line">    proposals.<span class="built_in">insert</span>(proposals.<span class="built_in">end</span>(), objects8.<span class="built_in">begin</span>(), objects8.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sort all proposals by score from highest to lowest</span></span><br><span class="line">    <span class="built_in">qsort_descent_inplace</span>(proposals);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// apply nms with nms_threshold</span></span><br><span class="line">    std::vector&lt;<span class="type">int</span>&gt; picked;</span><br><span class="line">    <span class="built_in">nms_sorted_bboxes</span>(proposals, picked, nms_threshold);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> count = picked.<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line">    ncnn::Mat mask_feat = ncnn::<span class="built_in">Mat</span>(<span class="number">32</span>, count, <span class="built_in">sizeof</span>(<span class="type">float</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; count; i++) {</span><br><span class="line">        <span class="type">float</span>* mask_feat_ptr = mask_feat.<span class="built_in">row</span>(i);</span><br><span class="line">        std::<span class="built_in">memcpy</span>(mask_feat_ptr, proposals[picked[i]].mask_feat.<span class="built_in">data</span>(), <span class="built_in">sizeof</span>(<span class="type">float</span>) * proposals[picked[i]].mask_feat.<span class="built_in">size</span>());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ncnn::Mat mask_pred_result;</span><br><span class="line">    <span class="built_in">decode_mask</span>(mask_feat, width, height, mask_proto, in_pad, wpad, hpad, mask_pred_result);</span><br><span class="line"></span><br><span class="line">    objects.<span class="built_in">resize</span>(count);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">    {</span><br><span class="line">        objects[i] = proposals[picked[i]];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// adjust offset to original unpadded</span></span><br><span class="line">        <span class="type">float</span> x0 = (objects[i].rect.x - (wpad / <span class="number">2</span>)) / scale;</span><br><span class="line">        <span class="type">float</span> y0 = (objects[i].rect.y - (hpad / <span class="number">2</span>)) / scale;</span><br><span class="line">        <span class="type">float</span> x1 = (objects[i].rect.x + objects[i].rect.width - (wpad / <span class="number">2</span>)) / scale;</span><br><span class="line">        <span class="type">float</span> y1 = (objects[i].rect.y + objects[i].rect.height - (hpad / <span class="number">2</span>)) / scale;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// clip</span></span><br><span class="line">        x0 = std::<span class="built_in">max</span>(std::<span class="built_in">min</span>(x0, (<span class="type">float</span>)(width - <span class="number">1</span>)), <span class="number">0.f</span>);</span><br><span class="line">        y0 = std::<span class="built_in">max</span>(std::<span class="built_in">min</span>(y0, (<span class="type">float</span>)(height - <span class="number">1</span>)), <span class="number">0.f</span>);</span><br><span class="line">        x1 = std::<span class="built_in">max</span>(std::<span class="built_in">min</span>(x1, (<span class="type">float</span>)(width - <span class="number">1</span>)), <span class="number">0.f</span>);</span><br><span class="line">        y1 = std::<span class="built_in">max</span>(std::<span class="built_in">min</span>(y1, (<span class="type">float</span>)(height - <span class="number">1</span>)), <span class="number">0.f</span>);</span><br><span class="line"></span><br><span class="line">        objects[i].rect.x = x0;</span><br><span class="line">        objects[i].rect.y = y0;</span><br><span class="line">        objects[i].rect.width = x1 - x0;</span><br><span class="line">        objects[i].rect.height = y1 - y0;</span><br><span class="line"></span><br><span class="line">        objects[i].mask = cv::Mat::<span class="built_in">zeros</span>(height, width, CV_32FC1);</span><br><span class="line">        cv::Mat mask = cv::<span class="built_in">Mat</span>(height, width, CV_32FC1, (<span class="type">float</span>*)mask_pred_result.<span class="built_in">channel</span>(i));</span><br><span class="line">        <span class="built_in">mask</span>(objects[i].rect).<span class="built_in">copyTo</span>(objects[i].<span class="built_in">mask</span>(objects[i].rect));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">XTY</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/04/20/%E5%B0%86yolov8%E9%83%A8%E7%BD%B2%E5%88%B0%E5%AE%89%E5%8D%93%E2%80%94%E2%80%94%E6%B5%8B%E8%AF%95/">http://example.com/2024/04/20/%E5%B0%86yolov8%E9%83%A8%E7%BD%B2%E5%88%B0%E5%AE%89%E5%8D%93%E2%80%94%E2%80%94%E6%B5%8B%E8%AF%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">泥嚎</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://images4.alphacoders.com/129/1291914.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/24/%E5%B0%86yolov8%E9%83%A8%E7%BD%B2%E5%88%B0%E5%AE%89%E5%8D%93%E2%80%94%E2%80%94%E5%BC%80%E5%8F%91/" title="将yolov8部署到安卓——开发"><img class="cover" src="https://pic.imgdb.cn/item/66160c2a68eb935713a25236.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">将yolov8部署到安卓——开发</div></div></a></div><div class="next-post pull-right"><a href="/2024/04/16/%E5%B0%86yolov8%E9%83%A8%E7%BD%B2%E5%88%B0%E5%AE%89%E5%8D%93%E2%80%94%E2%80%94%E5%AE%89%E8%A3%85/" title="将yolov8部署到安卓——安装"><img class="cover" src="https://images5.alphacoders.com/129/1291907.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">将yolov8部署到安卓——安装</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://pic.imgdb.cn/item/661611e968eb935713ab9f06.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info__name">XTY</div><div class="author-info__description">一个可怜的人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:3401849905@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/247960956" target="_blank" title="B站"><i class="fa-brands fa-bilibili"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%86yolov8%E9%83%A8%E7%BD%B2%E5%88%B0%E5%AE%89%E5%8D%93%E2%80%94%E2%80%94%E6%B5%8B%E8%AF%95"><span class="toc-number">1.</span> <span class="toc-text">将yolov8部署到安卓——测试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%8D%A2OpenCV%E7%89%88%E6%9C%AC"><span class="toc-number">1.1.</span> <span class="toc-text">更换OpenCV版本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#opencv-modules-included"><span class="toc-number">1.1.1.</span> <span class="toc-text">opencv modules included</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#opencv-modules-discarded"><span class="toc-number">1.1.2.</span> <span class="toc-text">opencv modules discarded</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%BD%AC%E6%8D%A2%EF%BC%88%E4%BB%A5Ultralytics%E5%AE%98%E6%96%B9%E6%8F%90%E4%BE%9B%E7%9A%84CoCo%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E9%A2%84%E8%AE%AD%E7%BB%83%E6%9D%83%E9%87%8D%E4%B8%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">模型转换（以Ultralytics官方提供的CoCo目标检测预训练权重为例）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85yolov8"><span class="toc-number">1.2.1.</span> <span class="toc-text">安装yolov8</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A6%96%E5%85%88%E6%98%AF%E5%85%B3%E4%BA%8E%E9%80%89%E6%8B%A9pip-install-ultralytics%E8%BF%98%E6%98%AFgit-clone%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">首先是关于选择pip install ultralytics还是git clone的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E6%A8%A1%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%8F%82%E6%95%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">关于模型转换参数的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E8%BD%AC%E6%8D%A2%E5%BE%97%E5%88%B0%E7%9A%84%E6%A8%A1%E5%9E%8B%E8%BE%93%E5%87%BA%E7%BB%B4%E5%BA%A6%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">关于转换得到的模型输出维度问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E8%BD%AC%E6%8D%A2%E5%BE%97%E5%88%B0%E7%9A%84%E6%A8%A1%E5%9E%8B%E7%BB%93%E6%9E%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">关于转换得到的模型结构问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.2.1.5.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%B5%8B%E8%AF%95"><span class="toc-number">1.3.</span> <span class="toc-text">代码测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#yolo-h"><span class="toc-number">1.3.1.</span> <span class="toc-text">yolo.h</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#yolo-cpp"><span class="toc-number">1.3.2.</span> <span class="toc-text">yolo.cpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#main-cpp"><span class="toc-number">1.3.3.</span> <span class="toc-text">main.cpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%86%85%E5%AE%B9%EF%BC%88%E5%8F%AA%E4%BF%AE%E6%94%B9yolo-cpp%EF%BC%8C%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84%E5%86%85%E5%AE%B9%E5%8F%82%E8%80%83%E4%B8%8A%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%89"><span class="toc-number">1.3.4.</span> <span class="toc-text">修改内容（只修改yolo.cpp，修改后的内容参考上面的代码）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E7%9A%84%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">加载的模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%88%AB%E6%95%B0%E9%87%8F%E5%92%8C%E7%B1%BB%E5%88%AB%E6%A0%87%E7%AD%BE"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">类别数量和类别标签</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C"><span class="toc-number">1.4.</span> <span class="toc-text">测试结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-number">1.5.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A8%E7%90%86%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB"><span class="toc-number">1.6.</span> <span class="toc-text">推理代码解读</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Object%E7%B1%BB"><span class="toc-number">1.7.</span> <span class="toc-text">Object类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GridAndStride%E7%B1%BB"><span class="toc-number">1.8.</span> <span class="toc-text">GridAndStride类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#main"><span class="toc-number">1.9.</span> <span class="toc-text">main</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#detect-yolo"><span class="toc-number">1.10.</span> <span class="toc-text">detect_yolo</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/07/09/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F/" title="冒泡排序"><img src="https://pic.imgdb.cn/item/66160c2a68eb935713a25236.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="冒泡排序"></a><div class="content"><a class="title" href="/2024/07/09/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F/" title="冒泡排序">冒泡排序</a><time datetime="2024-07-09T02:33:14.000Z" title="发表于 2024-07-09 10:33:14">2024-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/09/%E5%A0%86%E6%8E%92%E5%BA%8F/" title="堆排序"><img src="https://pic.imgdb.cn/item/66160c2a68eb935713a25236.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="堆排序"></a><div class="content"><a class="title" href="/2024/07/09/%E5%A0%86%E6%8E%92%E5%BA%8F/" title="堆排序">堆排序</a><time datetime="2024-07-09T01:46:41.000Z" title="发表于 2024-07-09 09:46:41">2024-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/08/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/" title="快速排序"><img src="https://pic.imgdb.cn/item/66160c2a68eb935713a25236.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="快速排序"></a><div class="content"><a class="title" href="/2024/07/08/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/" title="快速排序">快速排序</a><time datetime="2024-07-08T08:42:31.000Z" title="发表于 2024-07-08 16:42:31">2024-07-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/07/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F/" title="归并排序"><img src="https://pic.imgdb.cn/item/66160c2a68eb935713a25236.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="归并排序"></a><div class="content"><a class="title" href="/2024/07/07/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F/" title="归并排序">归并排序</a><time datetime="2024-07-07T09:38:23.000Z" title="发表于 2024-07-07 17:38:23">2024-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/07/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" title="插入排序"><img src="https://pic.imgdb.cn/item/66160c2a68eb935713a25236.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="插入排序"></a><div class="content"><a class="title" href="/2024/07/07/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" title="插入排序">插入排序</a><time datetime="2024-07-07T08:23:04.000Z" title="发表于 2024-07-07 16:23:04">2024-07-07</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">©2020 - 2024 By XTY</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>